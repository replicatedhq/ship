{
  "v1": {
    "config": {},
    "helmValues": "# Default values for elastic-stack.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\ningress:\n  enabled: false\n  # Used to create Ingress record (should used with service.type: ClusterIP).\n  hosts:\n  - chart-example.local\n  annotations:\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  tls:\n    # Secrets must be manually created in the namespace.\n    # - secretName: chart-example-tls\n    #   hosts:\n    #     - chart-example.local\n\n# elasticsearch subchart\nelasticsearch:\n  image:\n    repository: gcr.io/cos-containers/elasticsearch\n    tag: 5.4.2-xpack\n    pullPolicy: Always\n  env:\n    XPACK_MONITORING_ENABLED: \"true\"\n\n# kibana subchart\nkibana:\n  image:\n    repository: docker.elastic.co/kibana/kibana\n    tag: 5.4.2\n    pullPolicy: IfNotPresent\n  env:\n    XPACK_MONITORING_ENABLED: \"true\"\n",
    "releaseName": "elastic-stack",
    "helmValuesDefaults": "# Default values for elastic-stack.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\ningress:\n  enabled: false\n  # Used to create Ingress record (should used with service.type: ClusterIP).\n  hosts:\n  - chart-example.local\n  annotations:\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  tls:\n    # Secrets must be manually created in the namespace.\n    # - secretName: chart-example-tls\n    #   hosts:\n    #     - chart-example.local\n\n# elasticsearch subchart\nelasticsearch:\n  image:\n    repository: gcr.io/cos-containers/elasticsearch\n    tag: 5.4.2-xpack\n    pullPolicy: Always\n  env:\n    XPACK_MONITORING_ENABLED: \"true\"\n\n# kibana subchart\nkibana:\n  image:\n    repository: docker.elastic.co/kibana/kibana\n    tag: 5.4.2\n    pullPolicy: IfNotPresent\n  env:\n    XPACK_MONITORING_ENABLED: \"true\"\n",
    "kustomize": {
      "overlays": {
        "ship": {
          "excludedBases": [
            "/charts/kibana/templates/configmap.yaml",
            "/charts/logstash/templates/pipeline-config.yaml",
            "/charts/logstash/templates/service.yaml",
            "/charts/logstash/templates/statefulset.yaml",
            "/charts/elasticsearch/templates/master-svc.yaml",
            "/charts/elasticsearch/templates/data-serviceaccount.yaml",
            "/charts/elasticsearch/templates/master-serviceaccount.yaml",
            "/charts/logstash/templates/patterns-config.yaml",
            "/charts/elasticsearch/templates/client-serviceaccount.yaml",
            "/charts/logstash/templates/poddisruptionbudget.yaml"
          ],
          "patches": {
            "/client-deployment.yaml": "apiVersion: apps/v1beta1\nkind: Deployment\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-1.15.1\n    component: client\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch-client\nspec:\n  template:\n    spec:\n      $setElementOrder/containers:\n      - name: elasticsearch\n      $setElementOrder/initContainers:\n      - name: sysctl\n      containers:\n      - $setElementOrder/env:\n        - name: SERVICE\n        - name: KUBERNETES_MASTER\n        - name: KUBERNETES_NAMESPACE\n        - name: NODE_DATA\n        - name: NODE_INGEST\n        - name: NODE_MASTER\n        - name: PROCESSORS\n        - name: ES_JAVA_OPTS\n        - name: MINIMUM_MASTER_NODES\n        $setElementOrder/volumeMounts:\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n        env:\n        - name: SERVICE\n          value: elastic-stack-elasticsearch-master\n        - name: KUBERNETES_MASTER\n          value: kubernetes.default.svc.cluster.local\n        - name: KUBERNETES_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: NODE_INGEST\n          value: \"false\"\n        - name: ES_JAVA_OPTS\n          value: -Djava.net.preferIPv4Stack=true -Xms512m -Xmx512m\n        - $patch: delete\n          name: DISCOVERY_SERVICE\n        image: gcr.io/cos-containers/elasticsearch:5.4.2-xpack\n        imagePullPolicy: Always\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - curl --request GET --silent --output /dev/null http://127.0.0.1:9200/_cluster/health?wait_for_status=yellow\n          httpGet: null\n        name: elasticsearch\n        readinessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - curl --request GET --silent --output /dev/null http://127.0.0.1:9200/_cluster/health?wait_for_status=yellow\n          httpGet: null\n        volumeMounts:\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n          readOnly: true\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n          name: config\n          readOnly: true\n          subPath: log4j2.properties\n      initContainers:\n      - image: busybox\n        name: sysctl\n      securityContext: null\n      serviceAccountName: elastic-stack-elasticsearch\n",
            "/client-svc.yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-1.15.1\n    component: client\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch-client\nspec:\n  $setElementOrder/ports:\n  - port: 9200\n  ports:\n  - name: null\n    port: 9200\n",
            "/configmap.yaml": "apiVersion: v1\ndata:\n  elasticsearch.yml: |-\n    cluster.name: elasticsearch\n\n    node.data: ${NODE_DATA:true}\n    node.master: ${NODE_MASTER:true}\n    node.ingest: ${NODE_INGEST:true}\n    node.name: ${HOSTNAME}\n\n    network.host: 0.0.0.0\n\n    cloud:\n      kubernetes:\n        service: ${SERVICE}\n        namespace: ${KUBERNETES_NAMESPACE}\n    # see https://github.com/kubernetes/kubernetes/issues/3595\n    bootstrap.memory_lock: ${BOOTSTRAP_MEMORY_LOCK:false}\n\n    discovery:\n      zen:\n        hosts_provider: kubernetes\n        minimum_master_nodes: ${MINIMUM_MASTER_NODES:2}\n\n    # see https://www.elastic.co/guide/en/x-pack/current/xpack-settings.html\n    xpack.ml.enabled: ${XPACK_ML_ENABLED:false}\n    xpack.monitoring.enabled: ${XPACK_MONITORING_ENABLED:false}\n    xpack.security.enabled: ${XPACK_SECURITY_ENABLED:false}\n    xpack.watcher.enabled: ${XPACK_WATCHER_ENABLED:false}\n\n    # see https://github.com/floragunncom/search-guard-ssl/blob/master/src/main/java/com/floragunn/searchguard/ssl/util/SSLConfigConstants.java#L28\n    searchguard.ssl.http.enabled: ${SEARCHGUARD_SSL_HTTP_ENABLED:false}\n    searchguard.ssl.transport.enabled: ${SEARCHGUARD_SSL_TRANSPORT_ENABLED:false}\n\n    # see https://github.com/elastic/elasticsearch-definitive-guide/pull/679\n    processors: ${PROCESSORS:}\n\n    # avoid split-brain w/ a minimum consensus of two masters plus a data node\n    gateway.expected_master_nodes: ${EXPECTED_MASTER_NODES:2}\n    gateway.expected_data_nodes: ${EXPECTED_DATA_NODES:1}\n    gateway.recover_after_time: ${RECOVER_AFTER_TIME:5m}\n    gateway.recover_after_master_nodes: ${RECOVER_AFTER_MASTER_NODES:2}\n    gateway.recover_after_data_nodes: ${RECOVER_AFTER_DATA_NODES:1}\n  log4j2.properties: |-\n    status = error\n\n    appender.console.type = Console\n    appender.console.name = console\n    appender.console.layout.type = PatternLayout\n    appender.console.layout.pattern = [%d{ISO8601}][%-5p][%-25c{1.}] %marker%m%n\n\n    rootLogger.level = info\n    rootLogger.appenderRef.console.ref = console\n\n    logger.searchguard.name = com.floragunn\n    logger.searchguard.level = info\n  post-start-hook.sh: null\n  pre-stop-hook.sh: |-\n    #!/bin/bash\n    set -e\n\n    SERVICE_ACCOUNT_PATH=/var/run/secrets/kubernetes.io/serviceaccount\n    KUBE_TOKEN=$(\u003c${SERVICE_ACCOUNT_PATH}/token)\n    KUBE_NAMESPACE=$(\u003c${SERVICE_ACCOUNT_PATH}/namespace)\n\n    STATEFULSET_NAME=$(echo \"${HOSTNAME}\" | sed 's/-[0-9]*$//g')\n    INSTANCE_ID=$(echo \"${HOSTNAME}\" | grep -o '[0-9]*$')\n\n    echo \"Prepare stopping of Pet ${KUBE_NAMESPACE}/${HOSTNAME} of StatefulSet ${KUBE_NAMESPACE}/${STATEFULSET_NAME} instance_id ${INSTANCE_ID}\"\n\n    INSTANCES_DESIRED=$(curl -s \\\n      --cacert ${SERVICE_ACCOUNT_PATH}/ca.crt \\\n      -H \"Authorization: Bearer $KUBE_TOKEN\" \\\n      \"https://${KUBERNETES_SERVICE_HOST}:${KUBERNETES_PORT_443_TCP_PORT}/apis/apps/v1beta1/namespaces/${KUBE_NAMESPACE}/statefulsets/${STATEFULSET_NAME}/status\" | jq -r '.spec.replicas')\n\n    echo \"Desired instance count is ${INSTANCES_DESIRED}\"\n\n    if [ \"${INSTANCE_ID}\" -lt \"${INSTANCES_DESIRED}\" ]; then\n      echo \"No data migration needed\"\n      exit 0\n    fi\n\n    echo \"Prepare to migrate data of the node\"\n\n    NODE_STATS=$(curl -s -XGET 'http://localhost:9200/_nodes/stats')\n    NODE_IP=$(echo \"${NODE_STATS}\" | jq -r \".nodes[] | select(.name==\\\"${HOSTNAME}\\\") | .host\")\n\n    echo \"Move all data from node ${NODE_IP}\"\n\n    curl -s -XPUT localhost:9200/_cluster/settings -d \"{\n      \\\"transient\\\" :{\n          \\\"cluster.routing.allocation.exclude._ip\\\" : \\\"${NODE_IP}\\\"\n      }\n    }\"\n    echo\n\n    echo \"Wait for node to become empty\"\n    DOC_COUNT=$(echo \"${NODE_STATS}\" | jq \".nodes[] | select(.name==\\\"${HOSTNAME}\\\") | .indices.docs.count\")\n    while [ \"${DOC_COUNT}\" -gt 0 ]; do\n      NODE_STATS=$(curl -s -XGET 'http://localhost:9200/_nodes/stats')\n      DOC_COUNT=$(echo \"${NODE_STATS}\" | jq -r \".nodes[] | select(.name==\\\"${HOSTNAME}\\\") | .indices.docs.count\")\n      echo \"Node contains ${DOC_COUNT} documents\"\n      sleep 1\n    done\n\n    echo \"Wait for node shards to become empty\"\n    SHARD_STATS=$(curl -s -XGET 'http://localhost:9200/_cat/shards?format=json')\n    SHARD_COUNT=$(echo \"${SHARD_STATS}\" | jq \"[.[] | select(.node==\\\"${HOSTNAME}\\\")] | length\")\n    while [ \"${SHARD_COUNT}\" -gt 0 ]; do\n      SHARD_STATS=$(curl -s -XGET 'http://localhost:9200/_cat/shards?format=json')\n      SHARD_COUNT=$(echo \"${SHARD_STATS}\" | jq \"[.[] | select(.node==\\\"${HOSTNAME}\\\")] | length\")\n      echo \"Node contains ${SHARD_COUNT} shards\"\n      sleep 1\n    done\n\n    echo \"Node clear to shutdown\"\nkind: ConfigMap\nmetadata:\n  labels:\n    app: elastic-stack-elasticsearch\n    chart: elasticsearch-1.15.1\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch\n",
            "/data-statefulset.yaml": "apiVersion: apps/v1beta1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-1.15.1\n    component: data\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch-data\nspec:\n  template:\n    spec:\n      $setElementOrder/containers:\n      - name: elasticsearch\n      $setElementOrder/initContainers:\n      - name: sysctl\n      - name: chown\n      containers:\n      - $setElementOrder/env:\n        - name: SERVICE\n        - name: KUBERNETES_MASTER\n        - name: KUBERNETES_NAMESPACE\n        - name: NODE_MASTER\n        - name: PROCESSORS\n        - name: ES_JAVA_OPTS\n        - name: MINIMUM_MASTER_NODES\n        $setElementOrder/volumeMounts:\n        - mountPath: /usr/share/elasticsearch/data\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n        - mountPath: /pre-stop-hook.sh\n        env:\n        - name: SERVICE\n          value: elastic-stack-elasticsearch-master\n        - name: KUBERNETES_MASTER\n          value: kubernetes.default.svc.cluster.local\n        - name: KUBERNETES_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: ES_JAVA_OPTS\n          value: -Djava.net.preferIPv4Stack=true -Xms1536m -Xmx1536m\n        - $patch: delete\n          name: DISCOVERY_SERVICE\n        image: gcr.io/cos-containers/elasticsearch:5.4.2-xpack\n        imagePullPolicy: Always\n        lifecycle:\n          postStart: null\n        name: elasticsearch\n        readinessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - curl --request GET --silent --output /dev/null http://127.0.0.1:9200/_cluster/health?local=true\n          httpGet: null\n        volumeMounts:\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n          readOnly: true\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n          name: config\n          readOnly: true\n          subPath: log4j2.properties\n        - $patch: delete\n          mountPath: /post-start-hook.sh\n      initContainers:\n      - image: busybox\n        name: sysctl\n      - image: gcr.io/cos-containers/elasticsearch:5.4.2-xpack\n        imagePullPolicy: Always\n        name: chown\n      securityContext: null\n      serviceAccountName: elastic-stack-elasticsearch\n  updateStrategy: null\n  volumeClaimTemplates:\n  - metadata:\n      name: data\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 4Gi\n",
            "/deployment.yaml": "apiVersion: apps/v1beta1\nkind: Deployment\nmetadata:\n  labels:\n    app: kibana\n    chart: kibana-0.20.0\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-kibana\nspec:\n  revisionHistoryLimit: null\n  template:\n    metadata:\n      annotations: null\n    spec:\n      $setElementOrder/containers:\n      - name: kibana\n      containers:\n      - $setElementOrder/env:\n        - name: XPACK_MONITORING_ENABLED\n        - name: ELASTICSEARCH_URL\n        $setElementOrder/ports:\n        - containerPort: 5601\n        env:\n        - name: XPACK_MONITORING_ENABLED\n          value: \"true\"\n        - name: ELASTICSEARCH_URL\n          value: http://elastic-stack-elasticsearch:9200\n        image: docker.elastic.co/kibana/kibana:5.4.2\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 5601\n          initialDelaySeconds: 180\n        name: kibana\n        ports:\n        - containerPort: 5601\n          name: http\n          protocol: null\n        readinessProbe:\n          httpGet:\n            path: /status\n            port: 5601\n          initialDelaySeconds: 180\n          periodSeconds: 10\n        resources: null\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 1000\n        volumeMounts: null\n      serviceAccountName: null\n      tolerations: null\n      volumes: null\n",
            "/master-statefulset.yaml": "apiVersion: apps/v1beta1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-1.15.1\n    component: master\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch-master\nspec:\n  replicas: 2\n  template:\n    spec:\n      $setElementOrder/containers:\n      - name: elasticsearch\n      $setElementOrder/initContainers:\n      - name: sysctl\n      - name: chown\n      containers:\n      - $setElementOrder/env:\n        - name: SERVICE\n        - name: KUBERNETES_MASTER\n        - name: KUBERNETES_NAMESPACE\n        - name: NODE_DATA\n        - name: NODE_INGEST\n        - name: PROCESSORS\n        - name: ES_JAVA_OPTS\n        - name: MINIMUM_MASTER_NODES\n        $setElementOrder/volumeMounts:\n        - mountPath: /usr/share/elasticsearch/data\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n        env:\n        - name: SERVICE\n          value: elastic-stack-elasticsearch-master\n        - name: KUBERNETES_MASTER\n          value: kubernetes.default.svc.cluster.local\n        - name: KUBERNETES_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: NODE_INGEST\n          value: \"false\"\n        - name: ES_JAVA_OPTS\n          value: -Djava.net.preferIPv4Stack=true -Xms512m -Xmx512m\n        - $patch: delete\n          name: DISCOVERY_SERVICE\n        image: gcr.io/cos-containers/elasticsearch:5.4.2-xpack\n        imagePullPolicy: Always\n        name: elasticsearch\n        readinessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - curl --request GET --silent --output /dev/null http://127.0.0.1:9200/_cluster/health?local=true\n          httpGet: null\n        volumeMounts:\n        - mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\n          readOnly: true\n        - mountPath: /usr/share/elasticsearch/config/log4j2.properties\n          name: config\n          readOnly: true\n          subPath: log4j2.properties\n      initContainers:\n      - image: busybox\n        name: sysctl\n      - image: gcr.io/cos-containers/elasticsearch:5.4.2-xpack\n        imagePullPolicy: Always\n        name: chown\n      securityContext: null\n      serviceAccountName: elastic-stack-elasticsearch\n  updateStrategy: null\n",
            "/service.yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: kibana\n    chart: kibana-0.20.0\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-kibana\nspec:\n  $setElementOrder/ports:\n  - port: 80\n  ports:\n  - name: kibana\n    port: 80\n    protocol: TCP\n    targetPort: 5601\n  - $patch: delete\n    port: 443\n"
          },
          "resources": {
            "/client-pdb.yaml": "---\n# Source: elastic-stack/charts/elasticsearch/templates/client-pdb.yaml\napiVersion: policy/v1beta1\nkind: PodDisruptionBudget\nmetadata:\n  name: \"elastic-stack-elasticsearch-client\"\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-0.1.10\n    component: \"client\"\n    heritage: Tiller\n    release: elastic-stack\nspec:\n  selector:\n    matchLabels:\n      app: elasticsearch\n      component: \"client\"\n      release: elastic-stack\n  minAvailable: 1",
            "/data-pdb.yaml": "---\n# Source: elastic-stack/charts/elasticsearch/templates/data-pdb.yaml\napiVersion: policy/v1beta1\nkind: PodDisruptionBudget\nmetadata:\n  name: \"elastic-stack-elasticsearch-data\"\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-0.1.10\n    component: \"data\"\n    heritage: Tiller\n    release: elastic-stack\nspec:\n  selector:\n    matchLabels:\n      app: elasticsearch\n      component: \"data\"\n      release: elastic-stack\n  minAvailable: 1",
            "/master-pdb.yaml": "---\n# Source: elastic-stack/charts/elasticsearch/templates/master-pdb.yaml\napiVersion: policy/v1beta1\nkind: PodDisruptionBudget\nmetadata:\n  name: \"elastic-stack-elasticsearch-master\"\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-0.1.10\n    component: \"master\"\n    heritage: Tiller\n    release: elastic-stack\nspec:\n  selector:\n    matchLabels:\n      app: elasticsearch\n      component: \"master\"\n      release: elastic-stack\n  minAvailable: 1",
            "/master-svc.yaml": "---\n# Source: elastic-stack/charts/elasticsearch/templates/master-svc.yaml\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-0.1.10\n    component: \"master\"\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch-master\nspec:\n  clusterIP: None\n  ports:\n    - port: 9300\n      targetPort: 9300\n  selector:\n    app: elasticsearch\n    component: \"master\"\n    release: elastic-stack\n",
            "/service-account.yaml": "---\n# Source: elastic-stack/charts/elasticsearch/templates/service-account.yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  labels:\n    app: elasticsearch\n    chart: elasticsearch-0.1.10\n    heritage: Tiller\n    release: elastic-stack\n  name: elastic-stack-elasticsearch\n"
          }
        }
      }
    },
    "upstream": "https://github.com/helm/charts/tree/55c5a26458015c50fb5da5f6dfe5780cbbdb8ec9/stable/elastic-stack",
    "metadata": {
      "applicationType": "helm",
      "icon": "https://www.elastic.co/assets/bltb35193323e8f1770/logo-elastic-stack-lt.svg",
      "name": "elastic-stack",
      "releaseNotes": "Update elastic-stack to use latest logstash chart (#9201)\n\nSigned-off-by: Johnathan Rodgers \u003cjrodgers@powerhrg.com\u003e",
      "version": "1.1.0"
    },
    "contentSHA": "51f9431ec5b306a9a8e1fe31fc415f53931e2eaac061d858338b747659b7360b"
  }
}